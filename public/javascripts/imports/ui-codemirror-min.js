/**
 * Binds a CodeMirror widget to a <textarea> element.
 */
"use strict";angular.module("ui.codemirror",[]).constant("uiCodemirrorConfig",{}).directive("uiCodemirror",["uiCodemirrorConfig",function(a){return{restrict:"EA",require:"?ngModel",priority:1,compile:function(b){if(angular.isUndefined(window.CodeMirror))throw new Error("ui-codemirror need CodeMirror to work... (o rly?)");var c=b.text(),d=new window.CodeMirror(function(a){angular.forEach(b.prop("attributes"),function(b){"ui-codemirror"===b.name?a.setAttribute("ui-codemirror-opts",b.textContent):a.setAttribute(b.name,b.textContent)}),b.parent().length<=0&&b.wrap("<div>"),b.replaceWith(a)},{value:c});return function(b,c,e,f){function i(a){for(var b in a)a.hasOwnProperty(b)&&d.setOption(b,a[b])}var g,h;g=a.codemirror||{},h=angular.extend({},g,b.$eval(e.uiCodemirror),b.$eval(e.uiCodemirrorOpts)),i(h),angular.isDefined(b.$eval(e.uiCodemirror))&&b.$watch(e.uiCodemirror,i,!0),f&&(f.$formatters.push(function(a){if(angular.isUndefined(a)||null===a)return"";if(angular.isObject(a)||angular.isArray(a))throw new Error("ui-codemirror cannot use an object or an array as a model");return a}),f.$render=function(){var a=f.$viewValue||"";d.setValue(a)},d.on("change",function(a){var c=a.getValue();c!==f.$viewValue&&b.$apply(function(){f.$setViewValue(c)})})),e.uiRefresh&&b.$watch(e.uiRefresh,function(a,b){a!==b&&d.refresh()}),b.$on("CodeMirror",function(a,b){if(!angular.isFunction(b))throw new Error("the CodeMirror event requires a callback function");b(d)}),angular.isFunction(h.onLoad)&&h.onLoad(d)}}}}]);
